import{join}from"path";import{assembleFiles}from"codesandboxer-fs";import unescapeJS from"unescape-js";import{format}from"prettier";import"signale";const formatter=n=>format(n,{parser:"babylon",semi:!1,singleQuote:!0,trailingComma:"all"}),classComponent=n=>{const e=n.match(/(class)(\s)(\w+)/m);return`\n    {() => {\n      ${n}\n      return <${e&&e[3]} />\n    }}\n  `},checkCodeToRender=n=>n.startsWith("()")?`{${n}}`:n.startsWith("class")?classComponent(n):`<React.Fragment>${n}</React.Fragment>`,wrapCode=n=>`import React from 'react';\n  import { jsx } from '@emotion/core'\n\n  const doczStyles = {\n    margin: '0 3px',\n    padding: '4px 6px',\n    fontFamily: '"Source Code Pro", monospace',\n    fontSize: 14,\n  };\n\n  const App = ({ children }) => (\n    <div style={doczStyles}>\n      {children && typeof children === 'function' ? children() : children}\n    </div>\n  )\n\n  export default () => (\n    <App>\n      ${checkCodeToRender(unescapeJS(n))}\n    </App>\n  )`;function getSandboxFiles(n,e,o){const s=[...e,formatter(wrapCode(n))].join("\n"),t=join(o,"codesandbox.example.csb.js");return assembleFiles(t,{contents:s,extensions:[".js",".jsx",".ts",".tsx",".md",".html",".htm",".css",".css.less",".css.sass",".less",".sass",".scss",".svg",".png",".jpg",".jpeg"]})}const getSandboxImportInfo=async(n,e,o)=>{let s;try{const{parameters:t}=await getSandboxFiles(n,e,o);s=t}catch(n){console.error("Could not create Open in CodeSandbox",n)}return s};export{getSandboxImportInfo};
